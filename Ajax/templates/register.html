<!DOCTYPE html>
<!--suppress ALL -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<form method="post">
    <p>用户名<input type="text" name="username" onblur="fun1(this)">
    <span id="error"> </span>
    </p>

    <p>密码<input type="text" name="pwd">
    <span id="error"> </span>
    </p>
    <input type="submit" value="submit">

</form>

<script>
    
    function fun1(self) {

        var username = self.value

        var xmlhttp = createXMLHttpRequest()

        xmlhttp.open('POST','/ajax_register/',true)

        xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')

        xmlhttp.send('username='+username)

        xmlhttp.onreadystatechange()=function () {

            if (xmlhttp.readyState == 4&& xmlhttp.status == 200) {}

            var s = xmlhttp.responseText

            if (s == '1'){
                alert('ok')
                document.getElementById('error').innerHTML='用户名已经注册了！'
            }
        }

    }
     function createXMLHttpRequest() {
        var xmlHttp;
        try {
            xmlHttp = new XMLHttpRequest()
        }catch (e) {
            try {
                xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
            }catch (e) {
                try {
                    xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
                }catch (e) {}
            }
        }
        return xmlHttp;
    }
</script>

</body>
</html>